<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style2.css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="turn.js"></script>
    <link id="favicon" rel="shortcut icon" href="farmatodo.png">
    <link rel="icon" href="farmatodo.png" >
	<link rel="apple-touch-icon" href="farmatodo.png">
    <title>Promociones Farmatodo</title>

</head>

<body>

    <div class="container"> 
        <div id="divDeslizar" style="width: 100%;background-color: rgb(243, 247, 247);">
            <div class="neon-pulse" style="
                padding: 1px;               
                position: relative;              
                background-color: rgba(23,62,118);
                z-index: 1000;
                width: 160px;
                margin-right: 0px;
                float: right;
                margin-bottom: 10px;">
                <label class="lblIndicador" style="font-size: 9px; padding-left: 5px;float: left; margin-top: 5px; color: white;">Desliza para descubrir más </label>
                <img src="deslizar1.png" style="padding: 5px;width: 22px; float: right;" >
            </div>
        </div>

        <div>       
        <div class="flipbook">
            <div class=""><img src="page_1.jpg" alt="Página 1"></div>
            <div class=""><img src="page_2.jpg" alt="Página 2"></div>
            <div class=""><img src="page_3.jpg" alt="Página 3"></div>
            <div class=""><img src="page_4.jpg" alt="Página 4"></div>
            <div class=""><img src="page_5.jpg" alt="Página 5"></div>
            <div class=""><img src="page_6.jpg" alt="Página 6"></div>
            <div class=""><img src="page_7.jpg" alt="Página 7"></div>
            <div class=""><img src="page_8.jpg" alt="Página 8"></div>
            <div class=""><img src="page_9.jpg" alt="Página 9"></div>
            <div class=""><img src="page_10.jpg" alt="Página 10"></div>
            <div class=""><img src="page_11.jpg" alt="Página 11"></div>
            <div class=""><img src="page_12.jpg" alt="Página 12"></div>
            <div class=""><img src="page_13.jpg" alt="Página 13"></div>
            <div class=""><img src="page_14.jpg" alt="Página 14"></div>
            <div class=""><img src="page_15.jpg" alt="Página 15"></div>
            <div class=""><img src="page_16.jpg" alt="Página 16"></div>
            <div class=""><img src="page_17.jpg" alt="Página 17"></div>
            <div class=""><img src="page_18.jpg" alt="Página 18"></div>
            <div class=""><img src="page_19.jpg" alt="Página 19"></div>
            <div class=""><img src="page_20.jpg" alt="Página 20"></div>

        </div>
        
        <div class="controls">
            <button id="prev" class="prev-btn">&#8249;</button>
            <button id="next" class="next-btn">&#8250;</button>
        </div>
    </div>



    <script>

        var isMobile = 0;
        var Paginas1 = 0;
        var Paginas2 = 0;


        function getMagazineSize() {
            const viewportWidth = $(window).width();
            const viewportHeight = $(window).height();

            // Define un punto de quiebre para el diseño responsive
            isMobile = viewportWidth <= 768;

            let width = 0;
            let height = 0;
            let display = 'double';

            if (isMobile) {
                // En modo móvil, ajusta el tamaño para que sea de una sola página y ocupe casi todo el ancho de la pantalla
                width = viewportWidth * 0.7;
                height = (width) + 250 * (1100 / 1152); // Mantiene la relación de aspecto de las páginas
                display = 'single';
                esWeb = false;
            } else {
                // En modo de escritorio, ajusta el tamaño para que se adapte al viewport
                 width = viewportWidth * 0.8;
                 height = (width / 1152) * 762;
                display = 'double';
                esWeb = true;

                // Si el alto es muy grande para la pantalla, recalcula con el alto
                if (height > viewportHeight * 0.8) {
                    height = viewportHeight * 0.8;
                    width = (height / 752) * 1152;
                }
            }

            return {
                width: width,
                height: height,
                display: display
            };
        }

        function resizeMagazine() {
            const newSize = getMagazineSize();

            $('.flipbook').turn('size', newSize.width, newSize.height);
            $('.flipbook').turn('display', newSize.display);
          
        }

        $(window).ready(function () {

            
            // Inicializa el magazine con el tamaño correcto al cargar la página
            const initialSize = getMagazineSize();
            
        
            $('.flipbook').turn({
                autoCenter: true,
                duration: 900,
                width: initialSize.width,
                height: initialSize.height,
                display: initialSize.display,         
                when: {
                turned: function(e, page) {
                    debugger;
                    console.log('Current view: ', $(this).turn('view'));

                    Paginas1 = $(this).turn('view')[0];
                    Paginas2 = $(this).turn('view')[1];

                    if (Paginas1 == 0 || Paginas1 == 1 ){
                       document.getElementById('prev').style.visibility='hidden';
                    }
                    else
                      document.getElementById('prev').style.visibility='visible';

                    if (Paginas1 == 20){
                       document.getElementById('next').style.visibility='hidden';
                    }
                    else
                      document.getElementById('next').style.visibility='visible';

                }
                  
                }
            });

         

            // Vuelve a redimensionar el magazine cada vez que la ventana cambia de tamaño
            $(window).bind('resize', function () {           
                resizeMagazine();
            });

            $("#prev").on("click", function () {
                $(".flipbook").turn("previous");
                console.log(isMobile);
            });

            $("#next").on("click", function () {
                $(".flipbook").turn("next");
            });

            const totalPages = $(".flipbook").turn("pages");

            $("#page-info").text("1 / " + totalPages);

            $(".flipbook").bind("turned", function (event, page) {
                $("#page-info").text(page + " / " + totalPages);
            });

            $(window).bind('keydown', function (e) {
                const totalPages = $(".flipbook").turn("pages");
                switch (e.key) {
                    case "ArrowLeft":
                        $(".flipbook").turn("previous");
                        break;
                    case "ArrowRight":
                        $(".flipbook").turn("next");
                        break;
                    case "Home":
                        $(".flipbook").turn("page", 1);
                        break;
                    case "End":
                        $(".flipbook").turn("page", totalPages);
                        break;
                }
            });
        });

    </script>
</body>

</html>