<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="turn.js"></script>
    <link id="favicon" rel="shortcut icon" href="farmatodo.png">
    <link rel="icon" href="farmatodo.png">
    <link rel="apple-touch-icon" href="farmatodo.png">
    <title>Promociones Farmatodo</title>
</head>

<body>
    <div class="container"> 
        <!-- Header compacto -->
        

        <div>       
            <div class="flipbook">
                <div><img src="page_1.jpg" alt="P√°gina 1"></div>
                <div><img src="page_2.jpg" alt="P√°gina 2"></div>
                <div><img src="page_3.jpg" alt="P√°gina 3"></div>
                <div><img src="page_4.jpg" alt="P√°gina 4"></div>
                <div><img src="page_5.jpg" alt="P√°gina 5"></div>
                <div><img src="page_6.jpg" alt="P√°gina 6"></div>
                <div><img src="page_7.jpg" alt="P√°gina 7"></div>
                <div><img src="page_8.jpg" alt="P√°gina 8"></div>
                <div><img src="page_9.jpg" alt="P√°gina 9"></div>
                <div><img src="page_10.jpg" alt="P√°gina 10"></div>
                <div><img src="page_11.jpg" alt="P√°gina 11"></div>
                <div><img src="page_12.jpg" alt="P√°gina 12"></div>
                <div><img src="page_13.jpg" alt="P√°gina 13"></div>
                <div><img src="page_14.jpg" alt="P√°gina 14"></div>
                <div><img src="page_15.jpg" alt="P√°gina 15"></div>
                <div><img src="page_16.jpg" alt="P√°gina 16"></div>
                <div><img src="page_17.jpg" alt="P√°gina 17"></div>
                <div><img src="page_18.jpg" alt="P√°gina 18"></div>
                <div><img src="page_19.jpg" alt="P√°gina 19"></div>
                <div><img src="page_20.jpg" alt="P√°gina 20"></div>
            </div>
            
            <div class="controls">
                <button id="prev" class="carousel-btn left"></button>
                <button id="next" class="carousel-btn right"></button>
            </div>
            <!-- Texto abajo y centrado -->
            <div id="divDeslizar" class="indicador">
                <label>Desliza para descubrir m√°s</label>
            </div>
        </div>
    </div>

    <script>
        var isMobile = 0;
        var Paginas1 = 0;
        var Paginas2 = 0;

        function getMagazineSize() {
            const viewportWidth = $(window).width();
            const viewportHeight = $(window).height();

            isMobile = viewportWidth <= 768;

            let width = 0;
            let height = 0;
            let display = 'double';

            const aspectRatioSingle = 1024 / 1501;       // proporci√≥n 1 p√°gina
            const aspectRatioDouble = (1024 * 2) / 1501; // proporci√≥n 2 p√°ginas

            if (isMobile) {
                // üì± M√≥vil ‚Üí p√°gina individual
                width = viewportWidth * 0.95;
                height = width / aspectRatioSingle;
                display = 'single';

                if (height > viewportHeight * 0.9) {
                    height = viewportHeight * 0.9;
                    width = height * aspectRatioSingle;
                }

            } else {
                // üíª Escritorio ‚Üí dos p√°ginas
                width = viewportWidth * 0.9;
                height = width / aspectRatioDouble;

                if (height > viewportHeight * 0.9) {
                    height = viewportHeight * 0.9;
                    width = height * aspectRatioDouble;
                }

                display = 'double';
            }

            return { width, height, display };
        }

        function resizeMagazine() {
            const newSize = getMagazineSize();
            $('.flipbook').turn('size', newSize.width, newSize.height);
            $('.flipbook').turn('display', newSize.display);
        }

        $(window).ready(function () {
            const initialSize = getMagazineSize();
            
            $('.flipbook').turn({
                autoCenter: true,
                duration: 900,
                width: initialSize.width,
                height: initialSize.height,
                display: initialSize.display,         
                when: {
                    turned: function(e, page) {
                        Paginas1 = $(this).turn('view')[0];
                        Paginas2 = $(this).turn('view')[1];

                        if (Paginas1 == 0 || Paginas1 == 1) {
                            document.getElementById('prev').style.visibility='hidden';
                        } else {
                            document.getElementById('prev').style.visibility='visible';
                        }

                        if (Paginas1 == 20) {
                            document.getElementById('next').style.visibility='hidden';
                        } else {
                            document.getElementById('next').style.visibility='visible';
                        }
                    }
                }
            });

            $(window).bind('resize', function () {           
                resizeMagazine();
            });

            $("#prev").on("click", function () {
                $(".flipbook").turn("previous");
            });

            $("#next").on("click", function () {
                $(".flipbook").turn("next");
            });

            const totalPages = $(".flipbook").turn("pages");
            $("#page-info").text("1 / " + totalPages);

            $(".flipbook").bind("turned", function (event, page) {
                $("#page-info").text(page + " / " + totalPages);
            });

            $(window).bind('keydown', function (e) {
                const totalPages = $(".flipbook").turn("pages");
                switch (e.key) {
                    case "ArrowLeft":
                        $(".flipbook").turn("previous");
                        break;
                    case "ArrowRight":
                        $(".flipbook").turn("next");
                        break;
                    case "Home":
                        $(".flipbook").turn("page", 1);
                        break;
                    case "End":
                        $(".flipbook").turn("page", totalPages);
                        break;
                }
            });
        });
    </script>
</body>
</html>
